# 5.2 Циклы и функции

### Задание 1.

Напишите скрипт.

Скрипт должен выводить на экран все числа от 1 до 100, которые делятся на 3.

Для выполнения задания используйте цикл.

#### *Ответ:*
```bash
#!/bin/bash
echo -n "Все числа от 1 до 100, которые делятся на 3: "
for ((s=1;s<100;s+=1)); do
  [[ $((s%3)) -eq 0 ]] && echo -n "($s) "
done
echo
```
![](https://github.com/tverdyakov/portfolio-tverdyakov/blob/main/Experience%2C%20skills%20and%20abilities/Netology/05.%20Программирование%20на%20Bash/02.%20Циклы%20и%20функции/01.1.png)
![](https://github.com/tverdyakov/portfolio-tverdyakov/blob/main/Experience%2C%20skills%20and%20abilities/Netology/05.%20Программирование%20на%20Bash/02.%20Циклы%20и%20функции/01.2.png)

---

### Задание 2.

Напишите скрипт, который каждые 5 секунд будет выводить на экран текущее время и содержимое файла `/proc/loadavg`.

Для выполнения задания используйте цикл.

#### *Ответ:*
```bash
#!/bin/bash
while true ; do
  echo -n "$(date +%H:%M:%S) | " && cat /proc/loadavg
  sleep 5
done
```
![](https://github.com/tverdyakov/portfolio-tverdyakov/blob/main/Experience%2C%20skills%20and%20abilities/Netology/05.%20Программирование%20на%20Bash/02.%20Циклы%20и%20функции/02.1.png)
![](https://github.com/tverdyakov/portfolio-tverdyakov/blob/main/Experience%2C%20skills%20and%20abilities/Netology/05.%20Программирование%20на%20Bash/02.%20Циклы%20и%20функции/02.2.png)

---

### Задание 3.

Напишите функцию для подсчета среднего размера файла в директории. 

 - путь к директории должен передаваться параметром, например `avgfile /home/username`;
 - функция должна проверять, что такая директория существует, подсчитывать и выводить на экран средний размер файла в ней;
 - при подсчете не нужно учитывать поддиректории и символьные ссылки, считать только средний размер файлов в заданной директории.
 - для вывода среднего достаточно использовать целочисленное значение (стандартное деление в bash)

Предлагается выполнить задание сначала без открытия подсказки своим способом, при возникновении сложностей воспользоваться подробным алгоритмом решения, который описан ниже.
<details>
  <summary>Подсказка - Примерный алгоритм решения</summary>

  1. В скрипте объявите функцию. Поместите аргумент в переменную с понятным названием. Проверьте, существует ли заданная в аргументе директория с помощью if.

  2. Внутри функции объявите вспомогательные переменные. Одна переменная будет служить для сохранения суммы размеров всех файлов в директории, а другая будет содержать количество файлов.

  3. Для перебора файлов внутри директории используйте цикл for.

  4. Внутри цикла с помощью if проверяйте, является ли данный объект файлом.

  5. Если это файл, то к переменной суммы добавляйте размер файла и увеличивайте на один переменную с количеством файлов (получить размер одного файла можно с помощью `stat -c "%s" filename`).

  6. После выхода из цикла for (перебора всех файлов в директории), разделите значение переменной с суммой размеров файлов на количество этих файлов и выведите результат на экран.

  7. В конце скрипта, вызовите только что написанную функцию с аргументом, например `avgfile $1`

  8. Запускайте скрипт `./script3.sh /home/username` и смотрите результат. 
 
  9. (необязательно) Если все работает, данную функцию можно добавить к себе в `.bash_profile` и использовать для работы.

</details>

#### *Ответ:*
```bash
#!/bin/bash
function avgfilesize() {
if [[ ! -d $1 ]]; then
echo "Директория $1 не существует."
exit
fi
way=$1
	total_size=0
	total_files=0
for file in $way/*; do
if [[ -f $file ]]; then
((total_files+=1))
((total_size+=$(stat -c "%s" $file)))
fi
done	
	if [[ $total_files -eq 0 ]]; then
	echo "В директории $way нет файлов."
else
echo "Средний размер файла в директории $way равен $((total_size/total_files)) байт(а)."
fi
}
avgfilesize "$1"
```
![](https://github.com/tverdyakov/portfolio-tverdyakov/blob/main/Experience%2C%20skills%20and%20abilities/Netology/05.%20Программирование%20на%20Bash/02.%20Циклы%20и%20функции/03.1.png)
![](https://github.com/tverdyakov/portfolio-tverdyakov/blob/main/Experience%2C%20skills%20and%20abilities/Netology/05.%20Программирование%20на%20Bash/02.%20Циклы%20и%20функции/03.2.png)
![](https://github.com/tverdyakov/portfolio-tverdyakov/blob/main/Experience%2C%20skills%20and%20abilities/Netology/05.%20Программирование%20на%20Bash/02.%20Циклы%20и%20функции/03.3.png)

---
